<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GUJANICIC</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: #000;
            color: #0f0;
            font-family: 'Courier New', monospace;
            overflow: hidden;
            height: 100vh;
        }

        #intro {
            position: fixed;
            inset: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            background: #000;
        }

        #matrix-bg {
            position: absolute;
            inset: 0;
            font-size: 14px;
            line-height: 1.2;
            overflow: hidden;
            opacity: 0.6;
        }

        .matrix-col {
            position: absolute;
            top: -100%;
            color: #0f0;
            text-shadow: 0 0 8px #0f0;
            animation: fall linear infinite;
            white-space: pre;
        }

        @keyframes fall {
            to { transform: translateY(calc(100vh + 100%)); }
        }

        #glitch-text {
            font-size: clamp(32px, 8vw, 64px);
            font-weight: bold;
            letter-spacing: 8px;
            z-index: 10;
            text-shadow: 0 0 20px #0f0, 0 0 40px #0f0;
            animation: glitch 0.3s infinite;
        }

        @keyframes glitch {
            0%, 90%, 100% { transform: translate(0); }
            92% { transform: translate(-2px, 1px); }
            94% { transform: translate(2px, -1px); }
        }

        #enter-prompt {
            display: none;
            font-size: 16px;
            margin-top: 30px;
            z-index: 10;
            animation: blink 1s infinite;
            cursor: pointer;
            padding: 12px 24px;
            border: 1px solid #0f0;
        }

        #enter-prompt:hover { background: #0f0; color: #000; }

        @keyframes blink {
            50% { opacity: 0.3; }
        }

        #game {
            display: none;
            width: 100%;
            height: 100%;
            flex-direction: column;
        }

        #main-area {
            flex: 1;
            display: flex;
            position: relative;
        }

        #viewport {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: clamp(8px, 1.5vw, 14px);
            line-height: 1.1;
            white-space: pre;
            text-shadow: 0 0 4px #0f0;
        }

        #minimap {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 10px;
            border: 1px solid #0f0;
            background: rgba(0,0,0,0.8);
            font-size: 12px;
            line-height: 1;
            white-space: pre;
        }

        #minimap-title {
            text-align: center;
            margin-bottom: 8px;
            font-size: 10px;
            opacity: 0.7;
        }

        #hud {
            padding: 15px;
            border-top: 1px solid #0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #location { font-size: 14px; }

        #controls {
            display: flex;
            gap: 8px;
        }

        .btn {
            background: transparent;
            border: 1px solid #0f0;
            color: #0f0;
            padding: 8px 16px;
            font-family: inherit;
            font-size: 12px;
            cursor: pointer;
        }

        .btn:hover { background: #0f0; color: #000; }
        .btn:disabled { opacity: 0.2; cursor: not-allowed; }

        #room-content {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.95);
            z-index: 100;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px;
        }

        #room-content.visible { display: flex; }

        #room-content h1 {
            font-size: 28px;
            margin-bottom: 20px;
            text-shadow: 0 0 15px #0f0;
        }

        #room-content .content {
            text-align: center;
            font-size: 14px;
            line-height: 1.6;
        }

        #room-content a {
            color: #0f0;
            text-decoration: none;
            border: 1px solid #0f0;
            padding: 10px 20px;
            display: inline-block;
            margin-top: 15px;
        }

        #room-content a:hover { background: #0f0; color: #000; }

        #close-room {
            position: absolute;
            top: 20px;
            right: 20px;
            background: transparent;
            border: 1px solid #0f0;
            color: #0f0;
            padding: 8px 16px;
            font-family: inherit;
            cursor: pointer;
        }

        .easter-egg { animation: rainbow 2s infinite; }

        @keyframes rainbow {
            0% { color: #f00; text-shadow: 0 0 15px #f00; }
            33% { color: #0f0; text-shadow: 0 0 15px #0f0; }
            66% { color: #00f; text-shadow: 0 0 15px #00f; }
            100% { color: #f00; text-shadow: 0 0 15px #f00; }
        }
    </style>
</head>
<body>
    <div id="intro">
        <div id="matrix-bg"></div>
        <div id="glitch-text">GUJANICIC</div>
        <div id="enter-prompt" onclick="enterGame()">[ENTER]</div>
    </div>

    <div id="game">
        <div id="main-area">
            <div id="viewport"></div>
            <div id="minimap">
                <div id="minimap-title">MAP</div>
                <div id="minimap-grid"></div>
            </div>
        </div>
        <div id="hud">
            <div id="location"></div>
            <div id="controls">
                <button class="btn" onclick="turn('left')">[A]</button>
                <button class="btn" id="btn-fwd" onclick="move()">[W]</button>
                <button class="btn" onclick="turn('right')">[D]</button>
                <button class="btn" id="btn-enter" onclick="enterRoom()" style="display:none">[SPACE]</button>
            </div>
        </div>
    </div>

    <div id="room-content">
        <button id="close-room" onclick="closeRoom()">[ESC]</button>
        <div id="room-inner"></div>
    </div>

    <script>
        // INTRO
        function createMatrix() {
            const bg = document.getElementById('matrix-bg');
            const cols = Math.floor(window.innerWidth / 18);
            for (let i = 0; i < cols; i++) {
                const col = document.createElement('div');
                col.className = 'matrix-col';
                col.style.left = i * 18 + 'px';
                col.style.animationDuration = (2 + Math.random() * 2) + 's';
                col.style.animationDelay = Math.random() * 2 + 's';
                let t = '';
                for (let j = 0; j < 40; j++) t += (Math.random() > 0.5 ? '1' : '0') + '\n';
                col.textContent = t;
                bg.appendChild(col);
            }
        }

        createMatrix();
        setTimeout(() => document.getElementById('enter-prompt').style.display = 'block', 1500);

        function enterGame() {
            document.getElementById('intro').style.display = 'none';
            document.getElementById('game').style.display = 'flex';
            render();
        }

        document.addEventListener('keydown', e => {
            if (e.key === 'Enter' && document.getElementById('intro').style.display !== 'none') enterGame();
        });

        // MAP: 0=wall, 1=hall, 2=about, 3=easter, 4=linkedin
        const map = [
            [0,0,0,0,0,0,0,0,0,0,0],
            [0,2,2,0,3,3,0,4,4,4,0],
            [0,2,2,0,3,3,0,4,4,4,0],
            [0,1,1,1,1,1,1,1,1,1,0],
            [0,0,0,0,0,1,0,0,0,0,0],
            [0,0,0,0,0,1,0,0,0,0,0],
            [0,0,0,0,0,1,0,0,0,0,0],
            [0,0,0,0,0,0,0,0,0,0,0],
        ];

        const names = { 1: 'HALLWAY', 2: 'ABOUT', 3: '???', 4: 'LINKEDIN' };
        const explored = new Set();
        let px = 5, py = 6, pdir = 0;
        const dirs = [{dx:0,dy:-1,n:'N'},{dx:1,dy:0,n:'E'},{dx:0,dy:1,n:'S'},{dx:-1,dy:0,n:'W'}];

        function cell(x,y) { return (y>=0 && y<map.length && x>=0 && x<map[0].length) ? map[y][x] : 0; }
        function canGo(x,y) { return cell(x,y) !== 0; }

        function markExplored() {
            explored.add(`${px},${py}`);
            // reveal adjacent
            for (let dy = -1; dy <= 1; dy++) {
                for (let dx = -1; dx <= 1; dx++) {
                    explored.add(`${px+dx},${py+dy}`);
                }
            }
        }

        function renderMinimap() {
            let out = '';
            for (let y = 0; y < map.length; y++) {
                for (let x = 0; x < map[0].length; x++) {
                    if (x === px && y === py) {
                        out += ['^','>','v','<'][pdir];
                    } else if (!explored.has(`${x},${y}`)) {
                        out += '?';
                    } else if (map[y][x] === 0) {
                        out += '#';
                    } else if (map[y][x] === 1) {
                        out += '.';
                    } else {
                        out += '*';
                    }
                }
                out += '\n';
            }
            document.getElementById('minimap-grid').textContent = out;
        }

        function render3D() {
            const W = 50, H = 20;
            const v = Array.from({length:H}, () => Array(W).fill(' '));
            const d = dirs[pdir];
            const a1 = cell(px+d.dx, py+d.dy);
            const a2 = cell(px+d.dx*2, py+d.dy*2);
            const l1 = cell(px+dirs[(pdir+3)%4].dx, py+dirs[(pdir+3)%4].dy);
            const r1 = cell(px+dirs[(pdir+1)%4].dx, py+dirs[(pdir+1)%4].dy);

            // walls with depth
            const drawWall = (t,b,l,r,c) => {
                for(let y=t;y<b;y++) for(let x=l;x<r;x++) v[y][x] = c[(x+y)%2];
            };

            if(a2===0) drawWall(6,H-6,15,W-15,['0','1']);
            if(a1===0) drawWall(3,H-3,8,W-8,['0','1']);
            if(l1===0) for(let y=0;y<H;y++) for(let x=0;x<6;x++) if(Math.random()<(6-x)/8) v[y][x]=['0','1'][(x+y)%2];
            if(r1===0) for(let y=0;y<H;y++) for(let x=W-6;x<W;x++) if(Math.random()<(x-W+7)/8) v[y][x]=['0','1'][(x+y)%2];

            // door
            if(a1>1) {
                for(let x=15;x<W-15;x++) { v[4][x]='='; v[H-4][x]='='; }
                for(let y=4;y<H-3;y++) { v[y][15]='|'; v[y][W-16]='|'; }
                const lbl = names[a1] || '?';
                const lx = Math.floor((W-lbl.length)/2);
                for(let i=0;i<lbl.length;i++) v[6][lx+i] = lbl[i];
            }

            // floor/ceiling
            for(let x=0;x<W;x++) { v[0][x]=v[1][x]='`'[0]; v[H-1][x]=v[H-2][x]='.'; }

            return v.map(r=>r.join('')).join('\n');
        }

        function render() {
            markExplored();
            document.getElementById('viewport').textContent = render3D();
            renderMinimap();
            const d = dirs[pdir];
            const ahead = cell(px+d.dx, py+d.dy);
            document.getElementById('location').textContent = `${names[cell(px,py)]||'?'} [${d.n}]`;
            document.getElementById('btn-fwd').disabled = !canGo(px+d.dx, py+d.dy);
            document.getElementById('btn-enter').style.display = ahead > 1 ? 'inline-block' : 'none';
        }

        function move() {
            const d = dirs[pdir];
            if(canGo(px+d.dx, py+d.dy)) { px+=d.dx; py+=d.dy; render(); }
        }

        function turn(dir) {
            pdir = (pdir + (dir==='left' ? 3 : 1)) % 4;
            render();
        }

        function enterRoom() {
            const d = dirs[pdir];
            const ahead = cell(px+d.dx, py+d.dy);
            if(ahead > 1) showRoom(ahead);
        }

        function showRoom(type) {
            const inner = document.getElementById('room-inner');
            if(type === 2) {
                inner.innerHTML = `<h1>ABOUT</h1><div class="content"><p>DIMITRIJE GUJANICIC</p></div>`;
            } else if(type === 3) {
                inner.innerHTML = `<h1 class="easter-egg">???</h1><div class="content easter-egg"><p>YOU FOUND IT</p></div>`;
            } else if(type === 4) {
                inner.innerHTML = `<h1>LINKEDIN</h1><div class="content"><a href="https://www.linkedin.com/in/dimitrije-gujanicic/" target="_blank">[CONNECT]</a></div>`;
            }
            document.getElementById('room-content').classList.add('visible');
        }

        function closeRoom() { document.getElementById('room-content').classList.remove('visible'); }

        document.addEventListener('keydown', e => {
            if(document.getElementById('intro').style.display !== 'none') return;
            if(document.getElementById('room-content').classList.contains('visible')) {
                if(e.key==='Escape') closeRoom();
                return;
            }
            if(e.key==='w'||e.key==='ArrowUp') move();
            if(e.key==='a'||e.key==='ArrowLeft') turn('left');
            if(e.key==='d'||e.key==='ArrowRight') turn('right');
            if(e.key===' ') enterRoom();
        });
    </script>
</body>
</html>
